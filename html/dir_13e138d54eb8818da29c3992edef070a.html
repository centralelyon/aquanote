<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>aquanote: test Directory Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">aquanote
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dir_13e138d54eb8818da29c3992edef070a.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">test Directory Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="subdirs" name="subdirs"></a>
Directories</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top"><span class="iconfclosed"></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_cf6dd3d856136905faaf5b7bba187d4d.html">e2e</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top"><span class="iconfclosed"></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_bbf9f1b56ba6c621651be8934a24eced.html">integration</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top"><span class="iconfclosed"></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_6a07fdbc4b50e86806a88566ca8f66e4.html">unit</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top"><span class="iconfclosed"></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_aa9be1b82c48662217aefeaa0c6781c6.html">utils</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top"><span class="icondoc"></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8js.html">setup.js</a></td></tr>
<tr class="memdesc:setup_8js"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration d'environnement de test pour Vitest avec JSDOM. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Ce document prÃ©sente l'ensemble des tests du projet d'annotation de natation Neptune, leur organisation et leur couverture.</p>
<h1><a class="anchor" id="autotoc_md31"></a>
ğŸ“ Structure des Tests</h1>
<div class="fragment"><div class="line">test/</div>
<div class="line">â”œâ”€â”€ README.md                           # Cette documentation</div>
<div class="line">â”œâ”€â”€ setup.js                            # Configuration Vitest</div>
<div class="line">â”œâ”€â”€ utils/</div>
<div class="line">â”‚   â””â”€â”€ video-generator.js              # Utilitaire de gÃ©nÃ©ration de vidÃ©os MP4 pour tests</div>
<div class="line">â”œâ”€â”€ unit/                               # Tests unitaires</div>
<div class="line">â”‚   â”œâ”€â”€ cycles_handler.test.js          # Tests logiques cycles_handler</div>
<div class="line">â”‚   â”œâ”€â”€ homography_handler.test.js      # Tests logiques homography_handler</div>
<div class="line">â”‚   â”œâ”€â”€ side_views.test.js              # Tests logiques side_views</div>
<div class="line">â”‚   â””â”€â”€ svg_rendering.test.js           # Tests de rendu SVG/D3</div>
<div class="line">â”œâ”€â”€ integration/                        # Tests d&#39;intÃ©gration</div>
<div class="line">â”‚   â”œâ”€â”€ cycles_handler.test.js          # Tests intÃ©gration cycles_handler</div>
<div class="line">â”‚   â””â”€â”€ IMPROVEMENTS.md                 # Documentation amÃ©liorations tests</div>
<div class="line">â””â”€â”€ e2e/                               # Tests End-to-End (Playwright)</div>
<div class="line">    â”œâ”€â”€ fixtures.js                     # Configuration commune E2E</div>
<div class="line">    â”œâ”€â”€ annotation.spec.js              # Tests complets d&#39;annotation</div>
<div class="line">    â”œâ”€â”€ basic.spec.js                   # Tests de base serveur</div>
<div class="line">    â”œâ”€â”€ bars-functionality.spec.js      # Tests fonctionnalitÃ©s barres</div>
<div class="line">    â”œâ”€â”€ complete.spec.js                # Tests complets avec vidÃ©os</div>
<div class="line">    â””â”€â”€ video.spec.js                   # Tests spÃ©cifiques vidÃ©o</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md32"></a>
ğŸ§ª Types de Tests</h1>
<h2><a class="anchor" id="autotoc_md33"></a>
Tests Unitaires (<code>unit/</code>)</h2>
<h3><a class="anchor" id="autotoc_md34"></a>
<code>cycles_handler.test.js</code></h3>
<p><b>Objectif</b> : Tester la logique pure des fonctions de gestion des cycles <br  />
 <b>Framework</b> : Vitest <br  />
 <b>Couverture</b> :</p><ul>
<li>âœ… Logique <code>findCycleIndexAtFrame</code> (recherche de cycles par frame)</li>
<li>âœ… Formatage et validation des donnÃ©es de cycles</li>
<li>âœ… Calculs mathÃ©matiques de base</li>
</ul>
<p><b>Tests inclus</b> :</p><ul>
<li>Recherche de cycle par numÃ©ro de frame</li>
<li>Gestion des cas limites (frames nÃ©gatives, cycles vides)</li>
<li>Validation de la logique de tri temporel</li>
</ul>
<h3><a class="anchor" id="autotoc_md35"></a>
<code>homography_handler.test.js</code></h3>
<p><b>Objectif</b> : Tester les transformations gÃ©omÃ©triques et calculs de perspective <br  />
 <b>Framework</b> : Vitest <br  />
 <b>Couverture</b> :</p><ul>
<li>âœ… Logique de transformation de coordonnÃ©es (<code>getPoolBar</code>)</li>
<li>âœ… Calculs de mise Ã  l'Ã©chelle (pool_vid_xscale, pool_vid_yscale)</li>
<li>âœ… Gestion des transformations de perspective (PerspT)</li>
</ul>
<p><b>Tests inclus</b> :</p><ul>
<li>Calculs de coordonnÃ©es transformÃ©es</li>
<li>Gestion des cas limites (bords de l'image)</li>
<li>Validation des paramÃ¨tres de transformation</li>
</ul>
<h3><a class="anchor" id="autotoc_md36"></a>
<code>side_views.test.js</code></h3>
<p><b>Objectif</b> : Tester les fonctions de vues latÃ©rales et statistiques <br  />
 <b>Framework</b> : Vitest <br  />
 <b>Couverture</b> :</p><ul>
<li>âœ… Formatage des temps (mm:ss.cc)</li>
<li>âœ… Calculs de distances entre points</li>
<li>âœ… Conversions d'unitÃ©s et validations</li>
</ul>
<p><b>Tests inclus</b> :</p><ul>
<li>Formatage temporel avec gestion des centisecondes</li>
<li>Calculs de distances euclidiennes</li>
<li>Gestion des valeurs limites et erreurs</li>
</ul>
<h3><a class="anchor" id="autotoc_md37"></a>
<code>svg_rendering.test.js</code></h3>
<p><b>Objectif</b> : Tester le rendu SVG et les interactions D3.js <br  />
 <b>Framework</b> : Vitest + D3 <br  />
 <b>Couverture</b> :</p><ul>
<li>âœ… CrÃ©ation d'Ã©lÃ©ments SVG</li>
<li>âœ… Ajout de barres de cycles</li>
<li>âœ… Transformations et animations D3</li>
</ul>
<p><b>Tests inclus</b> :</p><ul>
<li>CrÃ©ation et configuration des conteneurs SVG</li>
<li>Rendu des barres de cycles avec donnÃ©es dynamiques</li>
<li>Validation des attributs et styles D3</li>
</ul>
<h2><a class="anchor" id="autotoc_md38"></a>
Tests d'IntÃ©gration (<code>integration/</code>)</h2>
<h3><a class="anchor" id="autotoc_md39"></a>
<code>cycles_handler.test.js</code></h3>
<p><b>Objectif</b> : Tester l'intÃ©gration des fonctions <code><a class="el" href="cycles__handler_8js.html" title="Ce fichier calcule et affiche les positions des barres d&#39;annotation sur le canvas vidÃ©o.">cycles_handler.js</a></code> <br  />
 <b>Framework</b> : Vitest avec mocks complets <br  />
</p>
<p><b>Fonctions testÃ©es complÃ¨tement</b> :</p><ul>
<li>âœ… <code>findCycleIndexAtFrame</code> - Recherche de cycles (performance, robustesse, cas limites)</li>
<li>âœ… <code>mode_color</code> - Dictionnaire de couleurs (intÃ©gritÃ©, format, cohÃ©rence)</li>
<li>âœ… <code>edit_lab_flipper</code> - ContrÃ´le d'affichage des labels</li>
<li>âœ… <code>highlightCycle</code> / <code>resetHigh</code> - Interactions D3 de surlignage</li>
</ul>
<p><b>Fonctions testÃ©es partiellement</b> :</p><ul>
<li>âš ï¸ <code>updateBarsFromEvent</code> - Tests structurels (logique de filtrage, paramÃ¨tres)</li>
<li>âš ï¸ <code>makeBar</code> - Tests de structure (donnÃ©es, calculs de base)</li>
</ul>
<p><b>Pourquoi certaines fonctions ne sont que partiellement testÃ©es</b> :</p><ul>
<li>Couplage DOM fort (manipulation directe via <code>document.getElementById</code>)</li>
<li>DÃ©pendances multiples (jQuery, D3, Canvas API, variables globales)</li>
<li>Ã‰tat global partagÃ© (modification de variables affectant d'autres modules)</li>
</ul>
<p><b>Tests spÃ©ciaux</b> :</p><ul>
<li>ğŸš€ Tests de performance avec 1000+ Ã©lÃ©ments</li>
<li>ğŸ›¡ï¸ Tests de robustesse (donnÃ©es corrompues, types mixtes)</li>
<li>ğŸ”„ Tests d'intÃ©gration entre fonctions</li>
<li>ğŸ“Š Tests de cohÃ©rence temporelle et visuelle</li>
</ul>
<h2><a class="anchor" id="autotoc_md40"></a>
Tests End-to-End (<code>e2e/</code>)</h2>
<h3><a class="anchor" id="autotoc_md41"></a>
<code>annotation.spec.js</code> (Tests principaux)</h3>
<p><b>Objectif</b> : Tests complets de l'application d'annotation <br  />
 <b>Framework</b> : Playwright <br  />
 <b>Navigateurs</b> : Chromium, Firefox, WebKit</p>
<p><b>ScÃ©narios testÃ©s</b> :</p><ul>
<li>âœ… Chargement interface principale</li>
<li>âœ… SÃ©lection et chargement de courses complÃ¨tes</li>
<li>âœ… Navigation entre compÃ©titions (Budapest â†” Montpellier)</li>
<li>âœ… Affichage des graphiques et barres de cycles</li>
<li>âœ… SÃ©lection de nageurs et synchronisation des vues</li>
<li>âœ… Interactions avec les barres de cycles</li>
<li>âœ… Chargement et initialisation de vidÃ©os</li>
<li>âœ… Tests de responsivitÃ© (1200px â†’ 400px)</li>
<li>âœ… <b>Mise Ã  jour dynamique des graphiques lors d'ajout de barres/annotations</b></li>
<li>âœ… <b>Navigation vidÃ©o via clic sur graphiques (barres/points dans #stats, #cyclebar, #cycle_stats)</b></li>
<li>âœ… <b>Synchronisation temps rÃ©el graphiques-annotations-vidÃ©o</b></li>
<li>âœ… <b>Tests d'interaction utilisateur avec Ã©lÃ©ments SVG (rect, circle, path)</b></li>
<li>âœ… <b>VÃ©rification de synchronisation timebar-vidÃ©o lors de clics sur graphiques</b></li>
<li>âœ… <b>Tests des tableaux de donnÃ©es synchronisÃ©s avec graphiques</b></li>
<li>âœ… <b>Navigation entre onglets avec persistance des graphiques</b></li>
</ul>
<p><b>Tests de graphiques spÃ©cialisÃ©s</b> :</p><ul>
<li>ğŸ“Š **#cyclebar** : Distance par cycle (interactions rect/circle)</li>
<li>ğŸ“Š **#stats** : Distance par seconde (interactions rect/circle/path) <br  />
</li>
<li>ğŸ“Š **#cycle_stats** : FrÃ©quence de cycle par vitesse (interactions circle)</li>
<li>ğŸ¯ <b>Synchronisation bidirectionnelle</b> : Graphiques â†” VidÃ©o â†” Timeline</li>
<li>âš™ï¸ <b>Tests modes d'affichage</b> : swim/last/all avec validation graphiques</li>
<li>ğŸ”„ <b>Persistance Ã©tat</b> : Navigation onglets sans perte de donnÃ©es</li>
</ul>
<p><b>DonnÃ©es mockÃ©es</b> :</p><ul>
<li>VidÃ©os MP4 gÃ©nÃ©rÃ©es dynamiquement</li>
<li>MÃ©tadonnÃ©es de compÃ©titions (Budapest, Montpellier)</li>
<li>DonnÃ©es de nageurs et cycles</li>
<li>ModÃ¨les ML pour prÃ©diction</li>
</ul>
<h3><a class="anchor" id="autotoc_md42"></a>
<code>bars-functionality.spec.js</code></h3>
<p><b>Objectif</b> : Tests spÃ©cifiques des fonctionnalitÃ©s de barres <br  />
 <b>Framework</b> : Playwright</p>
<p><b>FonctionnalitÃ©s testÃ©es</b> :</p><ul>
<li>âœ… CrÃ©ation et affichage des barres de cycles</li>
<li>âœ… Interactions utilisateur (clic, sÃ©lection)</li>
<li>âœ… Synchronisation entre vues multiples</li>
<li>âœ… Mise Ã  jour dynamique lors des changements</li>
</ul>
<p><b>Helpers inclus</b> :</p><ul>
<li><code>loadTestRace()</code> - Chargement standard d'une course</li>
<li><code>createMockBarData()</code> - GÃ©nÃ©ration de donnÃ©es de test</li>
</ul>
<h3><a class="anchor" id="autotoc_md43"></a>
<code>complete.spec.js</code></h3>
<p><b>Objectif</b> : Tests complets avec intÃ©gration vidÃ©o <br  />
 <b>Framework</b> : Playwright</p>
<p><b>ScÃ©narios avancÃ©s</b> :</p><ul>
<li>âœ… Chargement complet application + vidÃ©o</li>
<li>âœ… Tests avec vidÃ©os longues (5+ secondes)</li>
<li>âœ… Validation du cycle complet de l'application</li>
</ul>
<h3><a class="anchor" id="autotoc_md44"></a>
<code>video.spec.js</code></h3>
<p><b>Objectif</b> : Tests spÃ©cifiques du systÃ¨me vidÃ©o <br  />
 <b>Framework</b> : Playwright</p>
<p><b>Tests vidÃ©o</b> :</p><ul>
<li>âœ… Chargement et affichage de vidÃ©os mockÃ©es</li>
<li>âœ… ContrÃ´les vidÃ©o (play/pause/seek)</li>
<li>âœ… Synchronisation vidÃ©o-annotations</li>
</ul>
<h3><a class="anchor" id="autotoc_md45"></a>
<code>basic.spec.js</code></h3>
<p><b>Objectif</b> : Tests de base du serveur et connectivitÃ© <br  />
 <b>Framework</b> : Playwright</p>
<p><b>Tests fondamentaux</b> :</p><ul>
<li>âœ… Chargement application via HTTP</li>
<li>âœ… Mocks de base (package.json, endpoints essentiels)</li>
<li>âœ… Validation de la connectivitÃ© serveur</li>
</ul>
<h1><a class="anchor" id="autotoc_md46"></a>
ğŸ› ï¸ Utilitaires de Test</h1>
<h3><a class="anchor" id="autotoc_md47"></a>
<code>utils/video-generator.js</code></h3>
<p><b>Objectif</b> : GÃ©nÃ©ration de vidÃ©os MP4 minimales pour tests <br  />
 <b>FonctionnalitÃ©s</b> :</p><ul>
<li>CrÃ©ation de vidÃ©os MP4 valides avec durÃ©e/rÃ©solution personnalisÃ©es</li>
<li>Optimisation pour tests rapides</li>
<li>Format compatible avec les navigateurs</li>
</ul>
<h3><a class="anchor" id="autotoc_md48"></a>
<code>fixtures.js</code></h3>
<p><b>Objectif</b> : Configuration commune pour tests E2E <br  />
 <b>FonctionnalitÃ©s</b> :</p><ul>
<li>Configuration serveur de dÃ©veloppement</li>
<li>Mocks rÃ©seau partagÃ©s</li>
<li>Utilities communes Playwright</li>
</ul>
<h1><a class="anchor" id="autotoc_md49"></a>
ğŸ“Š Couverture de Test</h1>
<h2><a class="anchor" id="autotoc_md50"></a>
âœ… ComplÃ¨tement TestÃ©</h2>
<ul>
<li><b>Logique pure</b> : Calculs, transformations, formatage</li>
<li><b>Fonctions simples</b> : <code>findCycleIndexAtFrame</code>, <code>mode_color</code>, formatage temps</li>
<li><b>Rendu SVG</b> : CrÃ©ation Ã©lÃ©ments, attributs D3</li>
<li><b>Interface utilisateur</b> : Navigation, sÃ©lections, chargements</li>
</ul>
<h2><a class="anchor" id="autotoc_md51"></a>
âš ï¸ Partiellement TestÃ©</h2>
<ul>
<li><b>Fonctions complexes</b> : <code>updateBarsFromEvent</code>, <code>makeBar</code></li>
<li><b>IntÃ©grations lourdes</b> : Modules avec nombreuses dÃ©pendances</li>
</ul>
<h2><a class="anchor" id="autotoc_md52"></a>
ğŸ¯ Recommandations E2E</h2>
<ul>
<li><b>Rendu visuel complet</b> : Validation de l'affichage rÃ©el</li>
<li><b>Interactions utilisateur complexes</b> : Workflows complets</li>
<li><b>Performance</b> : Tests avec vraies donnÃ©es volumineuses</li>
</ul>
<h1><a class="anchor" id="autotoc_md53"></a>
ğŸš€ ExÃ©cution des Tests</h1>
<h2><a class="anchor" id="autotoc_md54"></a>
Tests Unitaires et IntÃ©gration</h2>
<div class="fragment"><div class="line"># Tous les tests Vitest</div>
<div class="line">npm test</div>
<div class="line"> </div>
<div class="line"># Tests unitaires seulement</div>
<div class="line">npm test unit/</div>
<div class="line"> </div>
<div class="line"># Tests d&#39;intÃ©gration seulement  </div>
<div class="line">npm test integration/</div>
<div class="line"> </div>
<div class="line"># Mode watch pour dÃ©veloppement</div>
<div class="line">npm test --watch</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md55"></a>
Tests E2E</h2>
<div class="fragment"><div class="line"># Tous les tests E2E</div>
<div class="line">npx playwright test</div>
<div class="line"> </div>
<div class="line"># Tests spÃ©cifiques</div>
<div class="line">npx playwright test annotation.spec.js</div>
<div class="line">npx playwright test bars-functionality.spec.js</div>
<div class="line"> </div>
<div class="line"># Mode debug</div>
<div class="line">npx playwright test --debug</div>
<div class="line"> </div>
<div class="line"># Tests avec interface graphique</div>
<div class="line">npx playwright test --ui</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md56"></a>
Configuration et Mocks</h2>
<div class="fragment"><div class="line"># Installation des dÃ©pendances</div>
<div class="line">npm install</div>
<div class="line"> </div>
<div class="line"># Setup Playwright</div>
<div class="line">npx playwright install</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md57"></a>
ğŸ“ˆ MÃ©triques de Test</h1>
<h2><a class="anchor" id="autotoc_md58"></a>
Performance</h2>
<ul>
<li><b>Tests unitaires</b> : &lt; 100ms par test</li>
<li><b>Tests intÃ©gration</b> : &lt; 500ms par test <br  />
</li>
<li><b>Tests E2E</b> : &lt; 30s par scÃ©nario complet</li>
</ul>
<h2><a class="anchor" id="autotoc_md59"></a>
Robustesse</h2>
<ul>
<li><b>Cas limites</b> : DonnÃ©es vides, valeurs extrÃªmes, types invalides</li>
<li><b>Gestion d'erreurs</b> : Exceptions, timeouts, Ã©checs rÃ©seau</li>
<li><b>CompatibilitÃ©</b> : Multi-navigateurs, rÃ©solutions diverses</li>
</ul>
<h1><a class="anchor" id="autotoc_md60"></a>
ğŸ”„ Maintenance</h1>
<h2><a class="anchor" id="autotoc_md61"></a>
Mise Ã  jour de cette documentation</h2>
<p>Ce fichier doit Ãªtre mis Ã  jour lors de :</p><ul>
<li>âœ… Ajout de nouveaux tests</li>
<li>âœ… Modification de la structure des tests</li>
<li>âœ… Changement des objectifs de couverture</li>
<li>âœ… Ã‰volution des outils de test</li>
</ul>
<h2><a class="anchor" id="autotoc_md62"></a>
Bonnes pratiques</h2>
<ul>
<li><b>Nommage</b> : Tests descriptifs avec objectifs clairs</li>
<li><b>Isolation</b> : Chaque test doit Ãªtre indÃ©pendant <br  />
</li>
<li><b>Mocks</b> : Minimiser les dÃ©pendances externes</li>
<li><b>Documentation</b> : Expliquer les choix de test complexes</li>
</ul>
<hr  />
<p><b>DerniÃ¨re mise Ã  jour</b> : Juillet 2025 <br  />
 <b>Maintenu par</b> : Ã‰quipe Neptune <br  />
 <b>Outils</b> : Vitest, Playwright, D3.js </p>
<h1><a class="anchor" id="autotoc_md64"></a>
Lancer les tests E2E</h1>
<p>npm run test:e2e</p>
<h1><a class="anchor" id="autotoc_md65"></a>
Tests E2E en mode headed (avec navigateur visible)</h1>
<p>npx playwright test &ndash;headed</p>
<h1><a class="anchor" id="autotoc_md66"></a>
Tests E2E d'un fichier spÃ©cifique</h1>
<p>npx playwright test <a class="el" href="bars-functionality_8spec_8js.html">test/e2e/bars-functionality.spec.js</a> </p><div class="fragment"><div class="line">### Tous les tests</div>
</div><!-- fragment --><p> bash </p>
<h1><a class="anchor" id="autotoc_md67"></a>
Lancer tous les tests (Vitest + Playwright)</h1>
<p>npm run test:all </p><div class="fragment"><div class="line">## Types de Tests</div>
<div class="line"> </div>
<div class="line">### Tests Unitaires (`test/unit/`)</div>
<div class="line"> </div>
<div class="line">Testent des fonctions individuelles en isolation :</div>
<div class="line">- **homography_handler.test.js** : Tests des transformations homographiques</div>
<div class="line">- **side_views.test.js** : Tests des fonctions de vue latÃ©rale et statistiques</div>
<div class="line">- **svg_rendering.test.js** : Tests du rendu SVG</div>
<div class="line"> </div>
<div class="line">### Tests d&#39;IntÃ©gration (`test/integration/`)</div>
<div class="line"> </div>
<div class="line">Testent l&#39;interaction entre plusieurs composants :</div>
<div class="line">- **cycles_handler.test.js** : Tests de la gestion des cycles et barres d&#39;annotation</div>
<div class="line"> </div>
<div class="line">### Tests E2E (`test/e2e/`)</div>
<div class="line"> </div>
<div class="line">Testent l&#39;application complÃ¨te dans un navigateur :</div>
<div class="line">- **annotation.spec.js** : Tests gÃ©nÃ©raux de l&#39;application</div>
<div class="line">- **bars-functionality.spec.js** : Tests spÃ©cifiques aux barres d&#39;annotation</div>
<div class="line"> </div>
<div class="line">## Configuration</div>
<div class="line"> </div>
<div class="line">### Vitest (vitest.config.js)</div>
<div class="line"> </div>
<div class="line">- **Environnement** : jsdom pour simuler le DOM</div>
<div class="line">- **Globaux** : describe, it, expect disponibles sans import</div>
<div class="line">- **Setup** : Fichier `test/setup.js` chargÃ© automatiquement</div>
<div class="line">- **Coverage** : Rapport de couverture avec v8</div>
<div class="line"> </div>
<div class="line">### Playwright (playwright.config.js)</div>
<div class="line"> </div>
<div class="line">- **Navigateurs** : Chrome, Firefox, Safari</div>
<div class="line">- **Serveur local** : DÃ©marre automatiquement un serveur HTTP</div>
<div class="line">- **Fixtures** : Gestion automatique des ports et ressources</div>
<div class="line"> </div>
<div class="line">## Mocking et Fixtures</div>
<div class="line"> </div>
<div class="line">### Variables Globales MockÃ©es</div>
<div class="line"> </div>
<div class="line">Le fichier `test/setup.js` configure automatiquement :</div>
<div class="line">- DOM via jsdom</div>
<div class="line">- jQuery et plugins UI</div>
<div class="line">- D3.js</div>
<div class="line">- PerspT (transformations de perspective)</div>
<div class="line">- fetch API</div>
<div class="line">- ResizeObserver</div>
<div class="line"> </div>
<div class="line">### Fixtures Playwright</div>
<div class="line"> </div>
<div class="line">Le fichier `test/e2e/fixtures.js` fournit :</div>
<div class="line">- Serveur HTTP local avec gestion automatique des ports</div>
<div class="line">- GÃ©nÃ©ration de vidÃ©os MP4 minimales pour les tests</div>
<div class="line">- Mocking des requÃªtes rÃ©seau</div>
<div class="line"> </div>
<div class="line">## CI/CD (GitHub Actions)</div>
<div class="line"> </div>
<div class="line">Le workflow `.github/workflows/ci.yml` exÃ©cute automatiquement :</div>
<div class="line"> </div>
<div class="line">1. **Setup** : Installation des dÃ©pendances</div>
<div class="line">2. **Lint** : VÃ©rification du code avec ESLint  </div>
<div class="line">3. **Tests Vitest** : Tests unitaires et d&#39;intÃ©gration</div>
<div class="line">4. **Coverage** : GÃ©nÃ©ration du rapport de couverture</div>
<div class="line">5. **Tests E2E** : Tests Playwright</div>
<div class="line">6. **Documentation** : GÃ©nÃ©ration de la documentation Doxygen</div>
<div class="line"> </div>
<div class="line">## Bonnes Pratiques</div>
<div class="line"> </div>
<div class="line">### Ã‰criture de Tests</div>
<div class="line"> </div>
<div class="line">1. **Nommage** : Utilisez des descriptions claires</div>
</div><!-- fragment --><p> javascript describe('FunctionName', () =&gt; { it('devrait faire quelque chose de spÃ©cifique', () =&gt; { // test }) }) </p><div class="fragment"><div class="line">2. **Isolation** : Chaque test doit Ãªtre indÃ©pendant</div>
</div><!-- fragment --><p> javascript beforeEach(() =&gt; { // Reset des mocks/Ã©tat }) </p><div class="fragment"><div class="line">3. **Assertions claires** : Utilisez des matchers expressifs</div>
</div><!-- fragment --><p> javascript expect(result).toBeInstanceOf(Array) expect(result).toHaveLength(2) expect(result[0]).toBeTypeOf('number') </p><div class="fragment"><div class="line">### Debugging</div>
<div class="line"> </div>
<div class="line">1. **Mode UI** : `npm run test:ui` pour interface graphique</div>
<div class="line">2. **Tests spÃ©cifiques** : `npx vitest run test/unit/specific.test.js`</div>
<div class="line">3. **Mode debug E2E** : `npx playwright test --headed --debug`</div>
<div class="line"> </div>
<div class="line">## Migration depuis Mocha</div>
<div class="line"> </div>
<div class="line">âœ… **TerminÃ©** : Tous les tests Mocha ont Ã©tÃ© migrÃ©s vers Vitest</div>
<div class="line">- Suppression des fichiers `test_mocha.mjs` et `test_homography.mjs`</div>
<div class="line">- Nouvelle structure organisÃ©e en `unit/` et `integration/`</div>
<div class="line">- Workflow GitHub mis Ã  jour</div>
<div class="line">- Commentaires dans le code source nettoyÃ©s</div>
<div class="line"> </div>
<div class="line">## Ressources</div>
<div class="line"> </div>
<div class="line">- [Documentation Vitest](https://vitest.dev/)</div>
<div class="line">- [Documentation Playwright](https://playwright.dev/)</div>
<div class="line">- [Matchers Vitest](https://vitest.dev/api/expect.html)</div>
<div class="line">- [API Playwright](https://playwright.dev/docs/api/class-page)</div>
<div class="line"> </div>
<div class="line">## ğŸ“ˆ Tests SpÃ©cialisÃ©s des Graphiques</div>
<div class="line"> </div>
<div class="line">### Tests de Mise Ã  Jour Dynamique des Graphiques</div>
<div class="line"> </div>
<div class="line">#### `devrait mettre Ã  jour dynamiquement les graphiques lors de l&#39;ajout de barres`</div>
<div class="line">**Objectif** : VÃ©rifier que les graphiques se mettent Ã  jour en temps rÃ©el lors de l&#39;ajout d&#39;annotations/barres</div>
<div class="line"> </div>
<div class="line">**Graphiques testÃ©s** :</div>
<div class="line">- `#cyclebar` - Distance par cycle (SVG ViewBox 0 0 200 200)</div>
<div class="line">- `#stats` - Distance par seconde (SVG ViewBox 0 0 200 200)  </div>
<div class="line">- `#cycle_stats` - FrÃ©quence de cycle par vitesse (SVG ViewBox 0 0 200 200)</div>
<div class="line"> </div>
<div class="line">**Processus de test** :</div>
<div class="line">1. Chargement complet d&#39;une course (Budapest brasse hommes 100m finaleA)</div>
<div class="line">2. Activation mode cycle (`#btn-cycle`)</div>
<div class="line">3. Comptage initial des Ã©lÃ©ments graphiques</div>
<div class="line">4. Simulation d&#39;ajout d&#39;annotations via dÃ©placement timeline + clics vidÃ©o</div>
<div class="line">5. VÃ©rification que le nombre d&#39;Ã©lÃ©ments graphiques â‰¥ nombre initial</div>
<div class="line">6. Validation des ViewBox SVG correctes</div>
<div class="line"> </div>
<div class="line">### Tests d&#39;Interaction avec les Graphiques</div>
<div class="line"> </div>
<div class="line">#### `devrait permettre de cliquer sur les barres et points des graphiques pour naviguer dans la vidÃ©o`</div>
<div class="line">**Objectif** : VÃ©rifier que les clics sur Ã©lÃ©ments graphiques dÃ©clenchent la navigation vidÃ©o</div>
<div class="line"> </div>
<div class="line">**Ã‰lÃ©ments interactifs testÃ©s** :</div>
<div class="line">- `#cyclebar rect` - Barres de cycles (rectangles)</div>
<div class="line">- `#cyclebar circle` - Points de cycles (cercles)</div>
<div class="line">- `#stats rect|circle|path` - Tous Ã©lÃ©ments graphiques de vitesse</div>
<div class="line">- `#cycle_stats circle|path` - Ã‰lÃ©ments de frÃ©quence</div>
<div class="line"> </div>
<div class="line">**Processus de test** :</div>
<div class="line">1. Chargement complet d&#39;une course avec vidÃ©o</div>
<div class="line">2. Enregistrement temps vidÃ©o initial (`video.currentTime`)</div>
<div class="line">3. DÃ©tection et comptage des Ã©lÃ©ments cliquables par graphique</div>
<div class="line">4. Simulation de clics sur chaque type d&#39;Ã©lÃ©ment</div>
<div class="line">5. VÃ©rification changement de temps vidÃ©o aprÃ¨s chaque clic</div>
<div class="line">6. Validation synchronisation `#timebar` avec navigation</div>
<div class="line"> </div>
<div class="line">**Logs de debug inclus** :</div>
</div><!-- fragment --><p> javascript console.log('Ã‰lÃ©ments cyclebar:', {rects, circles, lines, paths}) console.log(<code>Temps vidÃ©o initial: ${initialVideoTime}</code>) console.log(<code>Temps vidÃ©o aprÃ¨s clic: ${newVideoTime}</code>) </p><div class="fragment"><div class="line">### Tests de Synchronisation Graphiques-Annotations-VidÃ©o</div>
<div class="line"> </div>
<div class="line">#### `devrait synchroniser les graphiques avec les annotations et la vidÃ©o en temps rÃ©el`</div>
<div class="line">**Objectif** : VÃ©rifier la synchronisation complÃ¨te entre tous les Ã©lÃ©ments de l&#39;interface</div>
<div class="line"> </div>
<div class="line">**ScÃ©narios de synchronisation testÃ©s** :</div>
<div class="line">1. **Changement de nageur** : SÃ©lection via `#swim_switch` â†’ mise Ã  jour graphiques</div>
<div class="line">2. **Modes d&#39;affichage** : `#kmod` (swim/last/aucun) â†’ adaptation graphiques</div>
<div class="line">3. **Types d&#39;annotations** : `#btn-respi` â†” `#btn-cycle` â†’ cohÃ©rence visuelle</div>
<div class="line">4. **Navigation onglets** : `#tab-data-plot-tout` â†” `#tab-verification-charts` â†’ persistance</div>
<div class="line"> </div>
<div class="line">**Validations continues** :</div>
<div class="line">- VisibilitÃ© maintenue des 3 graphiques aprÃ¨s chaque changement</div>
<div class="line">- FonctionnalitÃ© `#timebar` et `#vid` prÃ©servÃ©e</div>
<div class="line">- Classes CSS actives correctes sur boutons de mode</div>
<div class="line"> </div>
<div class="line">## ğŸ¯ SpÃ©cificitÃ©s Techniques des Tests de Graphiques</div>
<div class="line"> </div>
<div class="line">### Ã‰lÃ©ments SVG SupportÃ©s</div>
<div class="line">- **Rectangles** (`rect`) : Barres de cycles, segments de donnÃ©es</div>
<div class="line">- **Cercles** (`circle`) : Points de donnÃ©es, marqueurs temporels</div>
<div class="line">- **Chemins** (`path`) : Courbes de tendance, lignes de donnÃ©es</div>
<div class="line">- **Lignes** (`line`) : Axes, sÃ©parateurs, connexions</div>
<div class="line"> </div>
<div class="line">### Assertions ClÃ©s</div>
</div><!-- fragment --><p> javascript // VÃ©rification ViewBox correctes expect(statsViewBox).toBe('0 0 200 200')</p>
<p>// VÃ©rification mise Ã  jour Ã©lÃ©ments expect(finalElements).toBeGreaterThanOrEqual(initialElements)</p>
<p>// VÃ©rification navigation vidÃ©o expect(finalVideoTime).not.toBe(initialVideoTime)</p>
<p>// VÃ©rification visibilitÃ© maintenue await expect(page.locator('#stats')).toBeVisible() ```</p>
<h3><a class="anchor" id="autotoc_md68"></a>
Gestion des Cas Limites</h3>
<ul>
<li><b>Graphiques vides</b> : Tests fonctionnent mÃªme sans Ã©lÃ©ments graphiques</li>
<li><b>DonnÃ©es manquantes</b> : Validation que les conteneurs SVG restent valides</li>
<li><b>Changements rapides</b> : <code>waitForTimeout()</code> pour stabilisation DOM</li>
<li><b>Ã‰tats transitoires</b> : VÃ©rifications multiples avec retry automatique </li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_13e138d54eb8818da29c3992edef070a.html">test</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
