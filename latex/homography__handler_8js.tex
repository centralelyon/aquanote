\doxysection{assets/js/homography\+\_\+handler.js File Reference}
\hypertarget{homography__handler_8js}{}\label{homography__handler_8js}\index{assets/js/homography\_handler.js@{assets/js/homography\_handler.js}}


gère les calculs d\textquotesingle{}homographie afin de passer d\textquotesingle{}un rectangle représantant une piscine vue du dessus à la vue de la caméra.  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
function export \mbox{\hyperlink{homography__handler_8js_ada1c852f359e457a53c5a4eb114294de}{get\+Point}} (\mbox{\hyperlink{refactor-script_8js_aeb8406986c3d3882c7f7eab3318583f7}{pt}}, \mbox{\hyperlink{refactor-script_8js_a92a715551e2d3bfed23b62cf2b6ea4da}{meta}})
\begin{DoxyCompactList}\small\item\em Transforme un point de coordonnées de piscine en coordonnées vidéo via homographie Utilise la calibration pour convertir des coordonnées métriques de la piscine en pixels vidéo. \end{DoxyCompactList}\item 
function export \mbox{\hyperlink{homography__handler_8js_a4f0f9d2190b999823cdd2ff092cb5c44}{get\+Point\+Inverted}} (\mbox{\hyperlink{refactor-script_8js_aeb8406986c3d3882c7f7eab3318583f7}{pt}}, \mbox{\hyperlink{refactor-script_8js_a92a715551e2d3bfed23b62cf2b6ea4da}{meta}})
\begin{DoxyCompactList}\small\item\em Transforme un point de coordonnées vidéo en coordonnées de piscine (transformation inverse) Convertit des coordonnées pixel de la vidéo en coordonnées métriques de la piscine. \end{DoxyCompactList}\item 
function export \mbox{\hyperlink{homography__handler_8js_a38f147071c255a1a1091b42f91836aca}{get\+Bar}} (\mbox{\hyperlink{refactor-script_8js_aeb8406986c3d3882c7f7eab3318583f7}{pt}}, \mbox{\hyperlink{refactor-script_8js_a92a715551e2d3bfed23b62cf2b6ea4da}{meta}}, swimmer)
\begin{DoxyCompactList}\small\item\em Cette fonction permet de calculer les points délimitant l\textquotesingle{}affichage des barres d\textquotesingle{}annotation sur une seule ligne. \end{DoxyCompactList}\item 
function export \mbox{\hyperlink{homography__handler_8js_a248b9f52a85315185e7f4b3c26efeeb8}{euc\+Distance}} (\mbox{\hyperlink{prettify_8js_ad0178804103ce8e65d787ee154d83f77}{a}}, b)
\begin{DoxyCompactList}\small\item\em Calcule la distance euclidienne entre deux points Fonction utilitaire pour mesurer la distance entre deux points dans un espace 2D. \end{DoxyCompactList}\item 
function export \mbox{\hyperlink{homography__handler_8js_a1075c22e5477e3b6bf05d3cf6b197d3f}{get\+\_\+orr}} (p1, p2)
\begin{DoxyCompactList}\small\item\em Calcule l\textquotesingle{}angle d\textquotesingle{}orientation entre deux points Détermine l\textquotesingle{}angle de rotation nécessaire pour orienter une ligne entre deux points. \end{DoxyCompactList}\item 
function export \mbox{\hyperlink{homography__handler_8js_a8e1178c66cdb3e21b314176a11d42c60}{get\+Pool\+Bar}} (\mbox{\hyperlink{refactor-script_8js_a9336ebf25087d91c818ee6e9ec29f8c1}{x}}, \mbox{\hyperlink{refactor-script_8js_a92a715551e2d3bfed23b62cf2b6ea4da}{meta}}, D3\+Instance=\mbox{\hyperlink{setup_8js_a98e30b2dfb63fe5803ad44d5d671ed61}{d3}})
\begin{DoxyCompactList}\small\item\em Une composante importante à comprendre est que le site fonctionne actuellement avec un ratio d\textquotesingle{}affichage vidéo fixe (largeur/hauteur environ = 1.\+89) Cela implique de ronger des vidéos qui n\textquotesingle{}auraient pas ce ratio précis. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{homography__handler_8js_a59be084da8908b7d77ff34b25cd84488}{import}} \{ \mbox{\hyperlink{assets_2js_2utils_8js_ac36e40331c83047a523340340124a006}{get\+Size}} \} \mbox{\hyperlink{jquery-ui_8js_ace03b192fd101a1c5648340bc09b7229}{from}} \textquotesingle{}./\mbox{\hyperlink{main_8js_a2e1c8cb1a275ecd4c6fdeb7c95982fca}{utils.\+js}}\textquotesingle{}
\item 
\mbox{\hyperlink{setup_8js_a92b303b76a3f942ea819498907d5e83c}{const}} \mbox{\hyperlink{homography__handler_8js_a42c7bf18082cfe1b260d748b99cf6a2e}{PerspT}} = window.\+PerspT
\item 
let \mbox{\hyperlink{homography__handler_8js_aa4eb5618998e5dfa1a2caa83d791ef46}{pool\+\_\+vid\+\_\+xscale}}
\item 
let \mbox{\hyperlink{homography__handler_8js_a9fcbe14cab453b6c508797242a4433c3}{pool\+\_\+vid\+\_\+yscale}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
gère les calculs d\textquotesingle{}homographie afin de passer d\textquotesingle{}un rectangle représantant une piscine vue du dessus à la vue de la caméra. 



\doxysubsection{Function Documentation}
\Hypertarget{homography__handler_8js_a248b9f52a85315185e7f4b3c26efeeb8}\index{homography\_handler.js@{homography\_handler.js}!eucDistance@{eucDistance}}
\index{eucDistance@{eucDistance}!homography\_handler.js@{homography\_handler.js}}
\doxysubsubsection{\texorpdfstring{eucDistance()}{eucDistance()}}
{\footnotesize\ttfamily \label{homography__handler_8js_a248b9f52a85315185e7f4b3c26efeeb8} 
function export euc\+Distance (\begin{DoxyParamCaption}\item[{}]{a}{, }\item[{}]{b}{}\end{DoxyParamCaption})}



Calcule la distance euclidienne entre deux points Fonction utilitaire pour mesurer la distance entre deux points dans un espace 2D. 


\begin{DoxyParams}{Parameters}
{\em \{array\}} & a Premier point \mbox{[}x, y\mbox{]} \\
\hline
{\em \{array\}} & b Deuxième point \mbox{[}x, y\mbox{]} \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\{number\} Distance euclidienne entre les deux points 
\end{DoxyReturn}
\Hypertarget{homography__handler_8js_a1075c22e5477e3b6bf05d3cf6b197d3f}\index{homography\_handler.js@{homography\_handler.js}!get\_orr@{get\_orr}}
\index{get\_orr@{get\_orr}!homography\_handler.js@{homography\_handler.js}}
\doxysubsubsection{\texorpdfstring{get\_orr()}{get\_orr()}}
{\footnotesize\ttfamily \label{homography__handler_8js_a1075c22e5477e3b6bf05d3cf6b197d3f} 
function export get\+\_\+orr (\begin{DoxyParamCaption}\item[{}]{p1}{, }\item[{}]{p2}{}\end{DoxyParamCaption})}



Calcule l\textquotesingle{}angle d\textquotesingle{}orientation entre deux points Détermine l\textquotesingle{}angle de rotation nécessaire pour orienter une ligne entre deux points. 


\begin{DoxyParams}{Parameters}
{\em \{array\}} & p1 Premier point \mbox{[}x, y\mbox{]} \\
\hline
{\em \{array\}} & p2 Deuxième point \mbox{[}x, y\mbox{]} \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\{number\} Angle en degrés (avec correction de +90°) 
\end{DoxyReturn}
\Hypertarget{homography__handler_8js_a38f147071c255a1a1091b42f91836aca}\index{homography\_handler.js@{homography\_handler.js}!getBar@{getBar}}
\index{getBar@{getBar}!homography\_handler.js@{homography\_handler.js}}
\doxysubsubsection{\texorpdfstring{getBar()}{getBar()}}
{\footnotesize\ttfamily \label{homography__handler_8js_a38f147071c255a1a1091b42f91836aca} 
function export get\+Bar (\begin{DoxyParamCaption}\item[{}]{pt}{, }\item[{}]{meta}{, }\item[{}]{swimmer}{}\end{DoxyParamCaption})}



Cette fonction permet de calculer les points délimitant l\textquotesingle{}affichage des barres d\textquotesingle{}annotation sur une seule ligne. 

Lire la documentation de get\+Pool\+Bar pour comprendre les lignes relatives à ratio\+\_\+affichage\+\_\+html. 
\begin{DoxyParams}{Parameters}
{\em \{\texorpdfstring{$\ast$}{*}\}} & pt indique à quel point on est avancé dans la piscine \\
\hline
{\em \{\texorpdfstring{$\ast$}{*}\}} & meta comporte les informations de la course et de comment elles ont été filmés, notamment de la calibration \\
\hline
{\em \{\texorpdfstring{$\ast$}{*}\}} & swimmer le nageur sur la ligne \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Les points pour faire une barre sur une seule ligne 
\end{DoxyReturn}
\Hypertarget{homography__handler_8js_ada1c852f359e457a53c5a4eb114294de}\index{homography\_handler.js@{homography\_handler.js}!getPoint@{getPoint}}
\index{getPoint@{getPoint}!homography\_handler.js@{homography\_handler.js}}
\doxysubsubsection{\texorpdfstring{getPoint()}{getPoint()}}
{\footnotesize\ttfamily \label{homography__handler_8js_ada1c852f359e457a53c5a4eb114294de} 
function export get\+Point (\begin{DoxyParamCaption}\item[{}]{pt}{, }\item[{}]{meta}{}\end{DoxyParamCaption})}



Transforme un point de coordonnées de piscine en coordonnées vidéo via homographie Utilise la calibration pour convertir des coordonnées métriques de la piscine en pixels vidéo. 


\begin{DoxyParams}{Parameters}
{\em \{array\}} & pt Point \mbox{[}x, y\mbox{]} en coordonnées de piscine (mètres) \\
\hline
{\em \{object\}} & meta Métadonnées de calibration vidéo contenant src\+Pts et dest\+Pts \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\{array\} Point transformé \mbox{[}x, y\mbox{]} en coordonnées vidéo (pixels) 
\end{DoxyReturn}
\Hypertarget{homography__handler_8js_a4f0f9d2190b999823cdd2ff092cb5c44}\index{homography\_handler.js@{homography\_handler.js}!getPointInverted@{getPointInverted}}
\index{getPointInverted@{getPointInverted}!homography\_handler.js@{homography\_handler.js}}
\doxysubsubsection{\texorpdfstring{getPointInverted()}{getPointInverted()}}
{\footnotesize\ttfamily \label{homography__handler_8js_a4f0f9d2190b999823cdd2ff092cb5c44} 
function export get\+Point\+Inverted (\begin{DoxyParamCaption}\item[{}]{pt}{, }\item[{}]{meta}{}\end{DoxyParamCaption})}



Transforme un point de coordonnées vidéo en coordonnées de piscine (transformation inverse) Convertit des coordonnées pixel de la vidéo en coordonnées métriques de la piscine. 


\begin{DoxyParams}{Parameters}
{\em \{array\}} & pt Point \mbox{[}x, y\mbox{]} en coordonnées vidéo normalisées (0-\/1) \\
\hline
{\em \{object\}} & meta Métadonnées de calibration vidéo \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\{array\} Point transformé \mbox{[}x, y\mbox{]} en coordonnées de piscine (mètres) 
\end{DoxyReturn}
\Hypertarget{homography__handler_8js_a8e1178c66cdb3e21b314176a11d42c60}\index{homography\_handler.js@{homography\_handler.js}!getPoolBar@{getPoolBar}}
\index{getPoolBar@{getPoolBar}!homography\_handler.js@{homography\_handler.js}}
\doxysubsubsection{\texorpdfstring{getPoolBar()}{getPoolBar()}}
{\footnotesize\ttfamily \label{homography__handler_8js_a8e1178c66cdb3e21b314176a11d42c60} 
function export get\+Pool\+Bar (\begin{DoxyParamCaption}\item[{}]{x}{, }\item[{}]{meta}{, }\item[{}]{D3\+Instance}{ = {\ttfamily \mbox{\hyperlink{setup_8js_a98e30b2dfb63fe5803ad44d5d671ed61}{d3}}}}\end{DoxyParamCaption})}



Une composante importante à comprendre est que le site fonctionne actuellement avec un ratio d\textquotesingle{}affichage vidéo fixe (largeur/hauteur environ = 1.\+89) Cela implique de ronger des vidéos qui n\textquotesingle{}auraient pas ce ratio précis. 

Ainsi, il est nécessaire de prendre cela en compte afin de corriger lors du placement des point d\textquotesingle{}annotation. Sans correction de ce type, une vidéo au format 3840\texorpdfstring{$\ast$}{*}2160 pourra être parfaitement calibrée mais les affichages seront au dessus car la vidéo sera rongé verticalement ainsi, on va venir corriger cet effet en bougeant artificiellement les points de calibration. @function get\+Pool\+Bar permet de calculer les 2 points délimitant chaque barre tracée dans l\textquotesingle{}application 
\begin{DoxyParams}{Parameters}
{\em x} & indique à quel point on est avancé dans la piscine \\
\hline
{\em meta} & comporte les informations de la course et de comment elles ont été filmés, notamment de la calibration \\
\hline
{\em D3\+Instance} & utile pour les tests automatisés \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
les 2 points délimitant chaque barre tracée dans l\textquotesingle{}application 
\end{DoxyReturn}


\doxysubsection{Variable Documentation}
\Hypertarget{homography__handler_8js_a59be084da8908b7d77ff34b25cd84488}\index{homography\_handler.js@{homography\_handler.js}!import@{import}}
\index{import@{import}!homography\_handler.js@{homography\_handler.js}}
\doxysubsubsection{\texorpdfstring{import}{import}}
{\footnotesize\ttfamily \label{homography__handler_8js_a59be084da8908b7d77ff34b25cd84488} 
import \{ \mbox{\hyperlink{assets_2js_2utils_8js_ac36e40331c83047a523340340124a006}{get\+Size}} \} \mbox{\hyperlink{jquery-ui_8js_ace03b192fd101a1c5648340bc09b7229}{from}} \textquotesingle{}./\mbox{\hyperlink{main_8js_a2e1c8cb1a275ecd4c6fdeb7c95982fca}{utils.\+js}}\textquotesingle{}}

\Hypertarget{homography__handler_8js_a42c7bf18082cfe1b260d748b99cf6a2e}\index{homography\_handler.js@{homography\_handler.js}!PerspT@{PerspT}}
\index{PerspT@{PerspT}!homography\_handler.js@{homography\_handler.js}}
\doxysubsubsection{\texorpdfstring{PerspT}{PerspT}}
{\footnotesize\ttfamily \label{homography__handler_8js_a42c7bf18082cfe1b260d748b99cf6a2e} 
\mbox{\hyperlink{setup_8js_a92b303b76a3f942ea819498907d5e83c}{const}} PerspT = window.\+PerspT}

\Hypertarget{homography__handler_8js_aa4eb5618998e5dfa1a2caa83d791ef46}\index{homography\_handler.js@{homography\_handler.js}!pool\_vid\_xscale@{pool\_vid\_xscale}}
\index{pool\_vid\_xscale@{pool\_vid\_xscale}!homography\_handler.js@{homography\_handler.js}}
\doxysubsubsection{\texorpdfstring{pool\_vid\_xscale}{pool\_vid\_xscale}}
{\footnotesize\ttfamily \label{homography__handler_8js_aa4eb5618998e5dfa1a2caa83d791ef46} 
let pool\+\_\+vid\+\_\+xscale}

\Hypertarget{homography__handler_8js_a9fcbe14cab453b6c508797242a4433c3}\index{homography\_handler.js@{homography\_handler.js}!pool\_vid\_yscale@{pool\_vid\_yscale}}
\index{pool\_vid\_yscale@{pool\_vid\_yscale}!homography\_handler.js@{homography\_handler.js}}
\doxysubsubsection{\texorpdfstring{pool\_vid\_yscale}{pool\_vid\_yscale}}
{\footnotesize\ttfamily \label{homography__handler_8js_a9fcbe14cab453b6c508797242a4433c3} 
let pool\+\_\+vid\+\_\+yscale}

